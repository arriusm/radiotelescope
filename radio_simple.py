#!/Users/arri/miniconda3/bin/python

import numpy             as np
import matplotlib.pyplot as plt
import sys

def onclick(event):
    if event.dblclick :
        print('%.0f,' % (event.xdata))


#####  mask version 20250601

newpeak = []

#startpeak=list(range(0,87+1))
startpeak=list(range(0,156+1))

brightpeak=list(range(1629,1647+1))

triplepeak=[ # immer 3 Linien im Abstand 13
    104,105,106,107,108,109,110,111,112,113,114,115,  122,  131,132,133,134,135,136,137,138,139,140,141,
    158,159,160,161,162,163,164,165,166,167,  185,186,187,188,189,190,191,192,193,194,195,196,
    231,232,233,  244,245,246,  257,258,259,
    316,317,318,  329,330,331,  343,344,
    402,403,  415,416,  428,429,
    461,462,  486,487,488,489,  499,500,501,502,  513,514,515,
    572,573,574,  585,586,587,  598,599,600,
    657,658,659,660,  669,670,671,672,673,675,  682,683,684,685,
    742,743,744,745,  755,756,757,758,759,  768,769,770,771,
    801,802,803,804,805,  827,828,829,830,  840,841,842,843,
    853,854,855,856,  880,881,882,  886,887,888,
    907,908,909,910,911,912,913,914,  923,924,925,926,927,928,  938,939,940,941,
    995,996,997,998,999,1000,  1011,1012,1013,  1024,1025,1026,
    1081,1082,1083,1084,1085,  1096,1097,1098,  1109,1110,1111,
    1167,1168,1169,1170,  1181,1182,1183,  1194,1195,1196,
    1236,1249,  1266,1267,1268,  1283,1284,  
    1338,1339,1340,  1351,1352,1353,  1364,1365,1366,
    1423,1424,1425,  1436,1437,1438,  1450,1451,
    1482,  1495,  1509,1510,1511,1512,
    1522,1523,1524,  1535,1536,1537,
    1593,1594,1595,1596,1597,  1606,1607,1608,1609,1610,  1619,1620,1621,1622,1623,
    1646,1647,1648,1649,  1674,  1679,1680,1681,
    1692,1693,1694,1696,1697,  1705,1706,1707,
    1763,1764,1765,1766,  1776,1777,1778,1779,1780,1781,1782, 1790,1791,1792,1793,1797, 1810,
    1849,1850,1851,  1862,1863,1864,  1875,1876,1877,
    1934,1935,1936,  1947,1948,1949,  1961,1962,1963,
    2019,2020,2021,2022,  2032,2033,2034,2035,  2046,2047,2048,
    2105,2106,2107,  2118,2119,2120,  2129,2130,2131,2132,2133,
    2190,2191,2192,  2203,2204,2205,  2216,2217,2218,
    2288,2289,  2290,2291,  2301,2302,2303,2304,  2316,
    2362,  2375, 2388,
    2444,2445,2446,2447,  2457,2458,2459,2460,  2470,2471,2472,2473,2474,
    2453,  2466,  2479,2480,2481,2482,2483,2484,2485,   2492,2493,   2498,2499,
    2530,2531,2532,  2544,2545,2546,  2557,2558,2559,
    2616,2617,2618,  2629,2630,2631,  2642,2643,2644,
    2701,2702,2703,  2714,2715,2716,2717,  2727,2728,2729,
    2786,2787,2788,  2799,2800,2801,  2812,2813,2814,
    2871,2872,2873,  2884,2885,2886,  2898,2899,
    2956,2957,2958,  2969,2970,2971,  2983,2984,
    3042,3043,  3055,3056,3057,  3068,3069,3070,  3083,3085, 
    3127,3128,3129,  3140,3141,3142,  3153,3154,3155,
    3193,  3205,3206,  3219,
    3212,3213,3214,  3225,3226,3227,3228,  3238,3239,3240,
    3297,3298,3299,3300,  3310,3311,3312,3313,  3323,3324,3325,
    3465,3466,3467,3468,3469,3470,  3478,3479,3480,3481,3482,3483,  3490,3491,3492,3493,3494,3495,3496,
    3554,  3565,3566,3567,  3579,3580,
    3638,3639,  3651,3652,3653,  3664,3665,3666,
    3721,3722,3723,3724,3725,  3736,3737,3738,  3749,3750,3751,
    3808,3809,3810,  3822,3823,  3835,3836,
    3683,3684,  3895,  3908,  3921,3922,3923,3924,
    3978,3979,3980,  3992,3993,  4006,
    4015,4016,4017,  4028,4029,4030,4031,  4041,4042,4043,
    4064,4065,  4077,  4090] 

doublepeak=[ # oft 2er Paare im Abstand 7
    88,95,  539,540,546,547,  563,564,565,566,  624,625,626,631,632,  709,710,711,  
    957,  965,966,972,973,  1050,1051,1052,1057,1058,1059,  1128,1136,1143,1145,
    1469,1477,  1562,1568,1569,1574,  1817,1824,  1884,1892,  1987,1988,1994,1995,2003,2004,2005, 
    2152,2157,2158, 2419,2420,2421,2426,  2963,2964,2965,  3266,3272,3273,
    3441,3442,3443,3444,3452 ]

singlepeak=[179, 444, 497, 615,616,  650,651,  736,737, 796,  872,
            957,  1163,1164, 1223,  1253,  1327, 1380, 1403,1404,1405,
            1543,  1671, 1769,  1713,  1738,1739,  1748,  1818,  1834,  1843,1844, 1855, 
            1902,1903,  1920, 1928,1929, 1941,1942, 1953, 1990, 
            2002,  2006,  2027,  2039,  
            2072,2073,2074,2075,2076,  2102, 2123,2124,2125, 2185,2186,  2213,  2224,
            2249,2250,  2275,2276,2277,  2329,    2591, 2608,  2663,2664,
            2761,  2840,  2843,2844,2845,  3084,  3187,  3246,  3351,
            3521,  3547, 3563,3564,  3685,3686,3687,3688,  3804,  4078,  4091] 

mask = startpeak + brightpeak + triplepeak + doublepeak + singlepeak + newpeak

#for i in mask :
#    print(i)

########

filename = sys.argv[1]

print('reading ',filename,' ...')
data = np.genfromtxt(filename) # ,max_rows=200)
n = data.shape[0]

fig=plt.figure(figsize=(12,6),facecolor='w')
cid = fig.canvas.mpl_connect('button_press_event', onclick)

for i in range(0,n) :
    #spec = data[i,28:28+4096]
    spec = data[i,27:27+4096]
    #plt.plot(spec,zorder=0,color='lightgrey',lw=1,alpha=0.01)
    spec[mask]=np.nan
    plt.plot(spec,zorder=0,color='blue',lw=1,alpha=0.01)


plt.xlim((300,3100))
plt.xlim((0,4200))
#plt.ylim((14000,35000))

#plt.savefig('radio_spectrum.png')
plt.savefig(filename+'_simple.png')
    
plt.show()

